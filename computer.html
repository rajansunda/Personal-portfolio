<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>3D Interactive Portfolio</title>
    <script src="https://cdn.jsdelivr.net/npm/three@0.128.0/build/three.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/three@0.128.0/examples/js/controls/OrbitControls.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/three@0.128.0/examples/js/loaders/GLTFLoader.min.js"></script>
    <style>
      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
      }

      body,
      html {
        height: 100%;
        overflow: hidden;
        background: linear-gradient(135deg, #0f0c29, #302b63, #24243e);
        font-family: "Segoe UI", Tahoma, Geneva, Verdana, sans-serif;
        color: #fff;
      }

      .container {
        position: relative;
        width: 100%;
        height: 100vh;
        display: flex;
        flex-direction: column;
        overflow: hidden;
      }

      header {
        background: rgba(0, 0, 0, 0.7);
        padding: 15px 30px;
        display: flex;
        justify-content: space-between;
        align-items: center;
        border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        z-index: 100;
      }

      .header-left {
        display: flex;
        align-items: center;
        gap: 20px;
      }

      .back-btn {
        background: linear-gradient(45deg, #ff8a00, #e52e71);
        color: white;
        border: none;
        padding: 8px 20px;
        border-radius: 30px;
        font-size: 16px;
        font-weight: 600;
        cursor: pointer;
        transition: all 0.3s ease;
        display: flex;
        align-items: center;
        gap: 8px;
        box-shadow: 0 4px 15px rgba(229, 46, 113, 0.3);
      }

      .back-btn:hover {
        transform: translateY(-2px);
        box-shadow: 0 6px 20px rgba(229, 46, 113, 0.5);
      }

      .logo {
        font-size: 28px;
        font-weight: 700;
        background: linear-gradient(90deg, #ff8a00, #e52e71);
        -webkit-background-clip: text;
        background-clip: text;
        -webkit-text-fill-color: transparent;
        letter-spacing: 1px;
      }

      nav ul {
        display: flex;
        list-style: none;
        gap: 25px;
      }

      nav a {
        color: #ddd;
        text-decoration: none;
        font-weight: 500;
        padding: 8px 15px;
        border-radius: 5px;
        transition: all 0.3s ease;
        font-size: 18px;
        position: relative;
      }

      nav a:hover {
        color: #fff;
      }

      nav a::after {
        content: "";
        position: absolute;
        bottom: 0;
        left: 0;
        width: 0;
        height: 2px;
        background: linear-gradient(90deg, #ff8a00, #e52e71);
        transition: width 0.3s ease;
      }

      nav a:hover::after {
        width: 100%;
      }

      .model-container {
        position: relative;
        flex: 1;
        height: calc(100vh - 120px);
        border-radius: 0;
        overflow: hidden;
        background: rgba(0, 0, 0, 0.3);
      }

      .info-panel {
        position: absolute;
        top: 100px;
        right: 30px;
        width: 320px;
        background: rgba(0, 0, 0, 0.85);
        padding: 25px;
        border-radius: 12px;
        border-left: 4px solid #e52e71;
        backdrop-filter: blur(10px);
        display: flex;
        flex-direction: column;
        box-shadow: 0 10px 25px rgba(0, 0, 0, 0.5);
        z-index: 50;
      }

      .info-panel h2 {
        font-size: 32px;
        margin-bottom: 20px;
        color: #e52e71;
        border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        padding-bottom: 10px;
      }

      .info-panel p {
        line-height: 1.7;
        margin-bottom: 20px;
        color: #ddd;
        font-size: 17px;
      }

      .hotspot-info {
        background: rgba(255, 255, 255, 0.05);
        padding: 15px;
        border-radius: 8px;
        margin-top: 15px;
      }

      .hotspot-info h3 {
        color: #ff8a00;
        margin-bottom: 10px;
        font-size: 20px;
      }

      canvas {
        display: block;
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
      }

      .loading {
        position: absolute;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
        color: white;
        font-size: 24px;
        z-index: 5;
        background: rgba(0, 0, 0, 0.7);
        padding: 20px 40px;
        border-radius: 10px;
        display: flex;
        flex-direction: column;
        align-items: center;
      }

      .loading-spinner {
        width: 50px;
        height: 50px;
        border: 5px solid rgba(255, 255, 255, 0.3);
        border-radius: 50%;
        border-top: 5px solid #e52e71;
        animation: spin 1s linear infinite;
        margin-bottom: 20px;
      }

      @keyframes spin {
        0% {
          transform: rotate(0deg);
        }
        100% {
          transform: rotate(360deg);
        }
      }

      .hotspot-label {
        position: absolute;
        background: rgba(0, 0, 0, 0.8);
        color: white;
        padding: 10px 20px;
        border-radius: 30px;
        font-size: 16px;
        pointer-events: none;
        opacity: 0;
        transform: translateY(10px);
        transition: all 0.3s ease;
        z-index: 20;
        border: 1px solid rgba(255, 255, 255, 0.2);
        box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
        font-weight: 500;
      }

      .controls {
        position: absolute;
        bottom: 20px;
        left: 20px;
        background: rgba(0, 0, 0, 0.7);
        padding: 15px 20px;
        border-radius: 10px;
        z-index: 10;
        font-size: 16px;
      }

      .controls p {
        margin-bottom: 10px;
        color: #aaa;
      }

      footer {
        position: absolute;
        bottom: 0;
        width: 100%;
        background: rgba(0, 0, 0, 0.7);
        padding: 15px;
        text-align: center;
        font-size: 16px;
        color: #aaa;
        border-top: 1px solid rgba(255, 255, 255, 0.1);
        z-index: 10;
      }

      .hotspot-counter {
        display: flex;
        gap: 15px;
        margin-top: 20px;
      }

      .counter-item {
        flex: 1;
        text-align: center;
        padding: 15px;
        background: rgba(255, 255, 255, 0.05);
        border-radius: 8px;
        transition: all 0.3s ease;
      }

      .counter-item:hover {
        background: rgba(229, 46, 113, 0.2);
        transform: translateY(-5px);
      }

      .counter-item h3 {
        font-size: 28px;
        color: #ff8a00;
        margin-bottom: 5px;
      }

      .counter-item p {
        font-size: 16px;
        color: #ddd;
        margin: 0;
      }

      .hotspot-guide {
        display: flex;
        flex-direction: column;
        gap: 8px;
        margin-top: 10px;
      }

      .guide-item {
        display: flex;
        align-items: center;
        gap: 10px;
      }

      .color-dot {
        width: 16px;
        height: 16px;
        border-radius: 50%;
      }

      .red-dot {
        background: #ff3366;
      }
      .green-dot {
        background: #33cc33;
      }
      .blue-dot {
        background: #3399ff;
      }
    </style>
  </head>
  <body>
    <div class="container">
      <header>
        <div class="header-left">
          <button class="back-btn" onclick="window.location.href='index.html'">
            ← Back to Portfolio
          </button>
          <div class="logo">3D PORTFOLIO</div>
        </div>
        <nav>
          <ul>
            <li><a href="#">About</a></li>
            <li><a href="#">Projects</a></li>
            <li><a href="#">Contact</a></li>
          </ul>
        </nav>
      </header>

      <div class="model-container">
        <div class="loading">
          <div class="loading-spinner"></div>
          <p>Loading 3D Experience...</p>
        </div>
        <div class="controls">
          <p>← → ↑ ↓ : Rotate Model</p>
          <p>Mouse Wheel : Zoom In/Out</p>
        </div>
      </div>

      <div class="info-panel">
        <h2>Interactive 3D Showcase</h2>
        <p>
          Explore my portfolio through this interactive 3D experience. Click on
          the glowing hotspots to discover different sections of my work.
        </p>

        <div class="hotspot-info">
          <h3>Hotspot Guide</h3>
          <div class="hotspot-guide">
            <div class="guide-item">
              <div class="color-dot red-dot"></div>
              <span>About Me & Skills</span>
            </div>
            <div class="guide-item">
              <div class="color-dot green-dot"></div>
              <span>Projects Showcase</span>
            </div>
            <div class="guide-item">
              <div class="color-dot blue-dot"></div>
              <span>Contact Information</span>
            </div>
          </div>
        </div>

        <div class="hotspot-counter">
          <div class="counter-item">
            <h3>3</h3>
            <p>Hotspots</p>
          </div>
          <div class="counter-item">
            <h3>12+</h3>
            <p>Projects</p>
          </div>
          <div class="counter-item">
            <h3>5★</h3>
            <p>Experience</p>
          </div>
        </div>
      </div>

      <footer>
        &copy; 2023 Interactive 3D Portfolio | Created with Three.js
      </footer>
    </div>

    <script>
      // Initialize Three.js
      const container = document.querySelector(".model-container");
      const loadingIndicator = document.querySelector(".loading");

      const scene = new THREE.Scene();
      scene.background = new THREE.Color(0x111118);

      const camera = new THREE.PerspectiveCamera(
        45,
        container.clientWidth / container.clientHeight,
        0.1,
        1000
      );
      // Start with a closer view
      camera.position.set(0, 1.5, 4);

      const renderer = new THREE.WebGLRenderer({
        antialias: true,
        alpha: false,
      });
      renderer.setSize(container.clientWidth, container.clientHeight);
      renderer.setPixelRatio(window.devicePixelRatio);
      container.appendChild(renderer.domElement);

      // Add lighting
      const ambientLight = new THREE.AmbientLight(0xffffff, 0.6);
      scene.add(ambientLight);

      const directionalLight1 = new THREE.DirectionalLight(0xffffff, 0.8);
      directionalLight1.position.set(3, 5, 2);
      scene.add(directionalLight1);

      const directionalLight2 = new THREE.DirectionalLight(0xffffff, 0.4);
      directionalLight2.position.set(-3, -2, -4);
      scene.add(directionalLight2);

      const hemisphereLight = new THREE.HemisphereLight(
        0xffffbb,
        0x080820,
        0.4
      );
      scene.add(hemisphereLight);

      // Add grid and axes helpers
      const gridHelper = new THREE.GridHelper(20, 20, 0x444444, 0x222222);
      scene.add(gridHelper);

      // Add orbit controls
      const controls = new THREE.OrbitControls(camera, renderer.domElement);
      controls.enableDamping = true;
      controls.dampingFactor = 0.05;
      controls.minDistance = 3; // Closer zoom
      controls.maxDistance = 8; // Limit zoom out
      controls.enablePan = false;

      // Create hotspot markers
      function createHotspot(position, color, target) {
        const geometry = new THREE.SphereGeometry(0.2, 16, 16); // Slightly larger
        const material = new THREE.MeshBasicMaterial({
          color: color,
          transparent: true,
          opacity: 0.8,
        });
        const sphere = new THREE.Mesh(geometry, material);
        sphere.position.copy(position);
        sphere.userData = { target: target };

        // Add pulsing animation
        let scale = 1;
        const animatePulse = () => {
          if (!sphere.userData.removed) {
            scale = 0.8 + 0.2 * Math.sin(Date.now() * 0.002);
            sphere.scale.set(scale, scale, scale);
            requestAnimationFrame(animatePulse);
          }
        };
        animatePulse();

        return sphere;
      }

      // Adjusted hotspot positions for better visibility
      const hotspots = [
        {
          position: new THREE.Vector3(1.2, 1.5, 0.8),
          color: 0xff3366,
          target: "about",
        },
        {
          position: new THREE.Vector3(-0.8, 1.2, 1.0),
          color: 0x33cc33,
          target: "projects",
        },
        {
          position: new THREE.Vector3(0.5, 0.8, -1.2),
          color: 0x3399ff,
          target: "contact",
        },
      ];

      // Load GLB model
      const loader = new THREE.GLTFLoader();
      let model;

      loader.load(
        "models/combi.glb",
        (gltf) => {
          model = gltf.scene;
          scene.add(model);

          // Scale and position model to fill more space
          model.scale.set(1.5, 1.5, 1.5);
          model.position.y = 1;

          // Add hotspots to the scene
          hotspots.forEach((hotspot) => {
            const marker = createHotspot(
              hotspot.position,
              hotspot.color,
              hotspot.target
            );
            scene.add(marker);
          });

          // Remove loading indicator
          if (loadingIndicator.parentNode) {
            loadingIndicator.parentNode.removeChild(loadingIndicator);
          }
        },
        undefined,
        (error) => {
          console.error("Error loading model:", error);
          loadingIndicator.textContent = "Error loading model. Check console.";
        }
      );

      // Handle window resize
      window.addEventListener("resize", () => {
        camera.aspect = container.clientWidth / container.clientHeight;
        camera.updateProjectionMatrix();
        renderer.setSize(container.clientWidth, container.clientHeight);
      });

      // Raycasting for hotspot interaction
      const raycaster = new THREE.Raycaster();
      const mouse = new THREE.Vector2();

      function onMouseMove(event) {
        // Calculate mouse position in normalized device coordinates
        const rect = renderer.domElement.getBoundingClientRect();
        mouse.x = ((event.clientX - rect.left) / rect.width) * 2 - 1;
        mouse.y = -((event.clientY - rect.top) / rect.height) * 2 + 1;

        // Update the picking ray with the camera and mouse position
        raycaster.setFromCamera(mouse, camera);

        // Remove any existing labels
        document
          .querySelectorAll(".hotspot-label")
          .forEach((el) => el.remove());

        // Calculate objects intersecting the picking ray
        const intersects = raycaster.intersectObjects(scene.children);

        for (let i = 0; i < intersects.length; i++) {
          const object = intersects[i].object;

          // Check if we have a hotspot
          if (object.userData.target) {
            // Get screen position of hotspot
            const vector = object.position.clone();
            vector.project(camera);

            const x = (vector.x * 0.5 + 0.5) * container.clientWidth;
            const y = (-vector.y * 0.5 + 0.5) * container.clientHeight;

            // Create label
            const label = document.createElement("div");
            label.className = "hotspot-label";
            label.textContent = object.userData.target.toUpperCase();
            label.style.left = x + "px";
            label.style.top = y - 40 + "px";
            container.appendChild(label);

            // Animate label appearance
            setTimeout(() => {
              label.style.opacity = "1";
              label.style.transform = "translateY(0)";
            }, 10);

            break;
          }
        }
      }

      function onMouseClick(event) {
        // Update the picking ray with the camera and mouse position
        raycaster.setFromCamera(mouse, camera);

        // Calculate objects intersecting the picking ray
        const intersects = raycaster.intersectObjects(scene.children);

        for (let i = 0; i < intersects.length; i++) {
          const object = intersects[i].object;

          // Check if we have a hotspot
          if (object.userData.target) {
            // Show alert for navigation
            alert(`Navigating to ${object.userData.target} section`);
            break;
          }
        }
      }

      // Event listeners
      renderer.domElement.addEventListener("mousemove", onMouseMove);
      renderer.domElement.addEventListener("click", onMouseClick);

      // Animation loop
      function animate() {
        requestAnimationFrame(animate);

        // Rotate model slowly
        if (model) {
          model.rotation.y += 0.002;
        }

        controls.update();
        renderer.render(scene, camera);
      }
      animate();
    </script>
  </body>
</html>
